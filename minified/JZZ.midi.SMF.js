!function(t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t:"function"==typeof define&&define.amd?define("JZZ.midi.SMF",["JZZ"],t):t(JZZ)}(function(p){var o,r,f;function d(t){throw new Error(t)}function n(t){var i="";return 2097151<t&&(i+=String.fromCharCode(128+(t>>21&127))),16383<t&&(i+=String.fromCharCode(128+(t>>14&127))),127<t&&(i+=String.fromCharCode(128+(t>>7&127))),i+=String.fromCharCode(127&t)}function e(t){return String.fromCharCode(t>>8)+String.fromCharCode(255&t)}function s(t){return String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(255&t)}function h(t){return String.fromCharCode(255&t)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>24&255)}function a(){var t,i,r=this instanceof a?this:new a,o=1,e=96;if(1==arguments.length){if(arguments[0]instanceof a)return arguments[0].copy();try{if(arguments[0]instanceof ArrayBuffer)return r.load(String.fromCharCode.apply(null,new Uint8Array(arguments[0]))),r}catch(t){}try{if(arguments[0]instanceof Uint8Array||arguments[0]instanceof Int8Array)return r.load(String.fromCharCode.apply(null,new Uint8Array(arguments[0]))),r}catch(t){}try{if(arguments[0]instanceof Buffer)return r.load(arguments[0].toString("binary")),r}catch(t){}if("string"==typeof arguments[0]&&"0"!=arguments[0]&&"1"!=arguments[0]&&"2"!=arguments[0])return r.load(arguments[0]),r;o=parseInt(arguments[0])}else 2==arguments.length?(o=parseInt(arguments[0]),e=parseInt(arguments[1])):3==arguments.length?(o=parseInt(arguments[0]),t=parseInt(arguments[1]),i=parseInt(arguments[2])):arguments.length&&d("Invalid parameters");return(isNaN(o)||o<0||2<o)&&d("Invalid parameters"),r.type=o,void 0===t?((isNaN(e)||e<0||65535<e)&&d("Invalid parameters"),r.ppqn=e):(24!=t&&25!=t&&29!=t&&30!=t&&d("Invalid parameters"),(isNaN(i)||i<0||255<i)&&d("Invalid parameters"),r.fps=t,r.ppf=i),r}function u(t,i,r,o){r={off:t,msg:i,data:r};return void 0!==o&&(r.tick=o),r}function c(t){if(!(this instanceof c))return new c(t);for(var i in t)t.hasOwnProperty(i)&&(this[i]=t[i])}function _(t){switch(240&t){case 128:case 144:case 160:case 176:case 224:return 2;case 192:case 208:return 1}switch(t){case 241:case 243:return 1;case 242:return 2}return 0}function l(t,i,r){if(!(this instanceof l))return new l(t,i,r);var o;if(this.sub[t])return this.sub[t](t,i,r);for("string"==typeof t&&4==t.length||d("Invalid chunk type: "+t),o=0;o<t.length;o++)(t.charCodeAt(o)<0||255<t.charCodeAt(o))&&d("Invalid chunk type: "+t);for("string"!=typeof i&&d("Invalid data type: "+i),o=0;o<i.length;o++)(i.charCodeAt(o)<0||255<i.charCodeAt(o))&&d("Invalid data character: "+i[o]);this.type=t,this.data=i,this.offset=r}function m(t,i,r,o,e,n){var s=i.substr(r,o);s.length<o&&(t._complain(n,"Incomplete track data",o-s.length,e),s=(s+"\0\0").substr(0,o));for(var h=0;h<o;h++)127<s.charCodeAt(h)&&(t._complain(n,"Bad MIDI value",s.charCodeAt(h),e),s=s.substr(0,h)+"\0"+s.substr(h+1));return s}function g(t,i,r,o,e){var n=function(t){if(!t.length)return 0;if(t.charCodeAt(0)<128)return[1,t.charCodeAt(0)];var i=127&t.charCodeAt(0);return i<<=7,t.charCodeAt(1)<128?[2,i+t.charCodeAt(1)]:(i+=127&t.charCodeAt(1),i<<=7,t.charCodeAt(2)<128?[3,i+t.charCodeAt(2)]:(i+=127&t.charCodeAt(2),i<<=7,i+=127&t.charCodeAt(3),[4,t.charCodeAt(3)<128?i:-i]))}(i);return e&&(o+=n[1]),n[1]<0?(n[1]=-n[1],t._complain(r,"Bad byte sequence",i.charCodeAt(0)+"/"+i.charCodeAt(1)+"/"+i.charCodeAt(2)+"/"+i.charCodeAt(3),o)):4==n[0]&&n[1]<2097152?t._complain(r,"Long VLQ value",i.charCodeAt(0)+"/"+i.charCodeAt(1)+"/"+i.charCodeAt(2)+"/"+i.charCodeAt(3),o):3==n[0]&&n[1]<16384?t._complain(r,"Long VLQ value",i.charCodeAt(0)+"/"+i.charCodeAt(1)+"/"+i.charCodeAt(2),o):2==n[0]&&n[1]<128&&t._complain(r,"Long VLQ value",i.charCodeAt(0)+"/"+i.charCodeAt(1),o),n}function y(t,i){if(!(this instanceof y))return new y(t,i);if(void((this._orig=this)._tick=0)!==t){var r,o,e,n=0,s=0,h="";for(i=i||0,i+=8;s<t.length;)s+=(o=g(this,t.substr(s,4),e,n,!0))[0],n+=o[1],e=s+i,255==t.charCodeAt(s)?((r=t.substr(s,2)).length<2&&(this._complain(e,"Incomplete track data",3-r.length,n),r="ÿ/"),s+=2,s+=(o=g(this,t.substr(s,4),e+2,n))[0],this.push(new I(n,r,t.substr(s,o[1]),e)),s+=o[1]):240==t.charCodeAt(s)||247==t.charCodeAt(s)?(r=t.substr(s,1),s+=1,s+=(o=g(this,t.substr(s,4),e+1,n))[0],this.push(new I(n,r,t.substr(s,o[1]),e)),s+=o[1]):128&t.charCodeAt(s)?(h=t.substr(s,1),s+=1,(o=_(h.charCodeAt(0)))||this._complain(e,"Unexpected MIDI message",h.charCodeAt(0),n),this.push(new I(n,h,m(this,t,s,o,n,e),e)),s+=o):128&h.charCodeAt(0)&&((o=_(h.charCodeAt(0)))||this._complain(e,"Unexpected MIDI message",h.charCodeAt(0),n),this.push(new I(n,h,m(this,t,s,o,n,e),e)),s+=o)}else this.push(new I(0,"ÿ/",""))}function C(t){t=t.toString();return t=80<t.length?(t=t.substr(0,78)).substr(0,t.lastIndexOf(" "))+" ...":t}function v(t,i,r){return t.dd.length<r?u(t._off,"Invalid "+i+" meta event: "+(t.dd.length?"data too short":"no data"),C(t),t.tt):t.dd.length>r?u(t._off,"Invalid "+i+" meta event: data too long",C(t),t.tt):void 0}function A(t,i){return u(t._off,i+" meta events must be in the first track",C(t),t.tt)}function I(t,i,r,o){var e;if(255==i.charCodeAt(0))e=p.MIDI.smf(i.charCodeAt(1),r);else{for(var n=[i.charCodeAt(0)],s=0;s<r.length;s++)n.push(r.charCodeAt(s));e=p.MIDI(n)}return void 0!==o&&(e._off=o),e.tt=t,e}function k(){var t,i,r=new p.Widget;for(i in r._info.name="MIDI Player",r._info.manufacturer="Jazz-Soft",r._info.version=o,r.playing=!1,r._loop=0,r._data=[],r._pos=0,r._tick=(t=r,function(){t.tick()}),k.prototype)k.prototype.hasOwnProperty(i)&&(r[i]=k.prototype[i]);return r}function i(t){this._receive(t)}function S(t){return(t.charCodeAt(0)<<16)+(t.charCodeAt(1)<<8)+t.charCodeAt(2)}p.MIDI.SMF||(o="1.5.0",r=p.lib.now,a.version=function(){return o},((a.prototype=[]).constructor=a).prototype.copy=function(){var t=new a;t.type=this.type,t.ppqn=this.ppqn,t.fps=this.fps,t.ppf=this.ppf,t.rmi=this.rmi,t.ntrk=this.ntrk;for(var i=0;i<this.length;i++)t.push(this[i].copy());return t},a.prototype._complain=function(t,i,r){this._warn||(this._warn=[]),this._warn.push(u(t,i,r))},a.prototype.load=function(t){var i=0;"RIFF"==t.substr(0,4)&&"RMIDdata"==t.substr(8,8)&&(this.rmi=!0,t=t.substr(i=20,t.charCodeAt(16)+256*t.charCodeAt(17)+65536*t.charCodeAt(18)+16777216*t.charCodeAt(19))),this.loadSMF(t,i)},f="MThd"+String.fromCharCode(0)+String.fromCharCode(0)+String.fromCharCode(0)+String.fromCharCode(6),a.prototype.loadSMF=function(t,i){var r;t.length||d("Empty file"),t.substr(0,8)!=f&&(-1!=(r=t.indexOf(f))?(t=t.substr(r),this._complain(i,"Extra leading characters",r),i+=r):d("Not a MIDI file")),this.type=16*t.charCodeAt(8)+t.charCodeAt(9),this.ntrk=16*t.charCodeAt(10)+t.charCodeAt(11),127<t.charCodeAt(12)?(this.fps=256-t.charCodeAt(12),this.ppf=t.charCodeAt(13)):this.ppqn=256*t.charCodeAt(12)+t.charCodeAt(13),2<this.type?this._complain(8+i,"Invalid MIDI file type",this.type):0==this.type&&1<this.ntrk&&this._complain(10+i,"Wrong number of tracks for the type 0 MIDI file",this.ntrk),this.ppf||this.ppqn||d("Invalid MIDI header");for(var o=0,e=14;e<t.length-8;){var n=e+i,s=t.substr(e,4);"MTrk"==s&&o++;var h=(t.charCodeAt(e+4)<<24)+(t.charCodeAt(e+5)<<16)+(t.charCodeAt(e+6)<<8)+t.charCodeAt(e+7);h<=0&&(h=t.length-e-8,this._complain(e+i+4,"Invalid track length",t.charCodeAt(e+4)+"/"+t.charCodeAt(e+5)+"/"+t.charCodeAt(e+6)+"/"+t.charCodeAt(e+7))),e+=8;var a=t.substr(e,h);this.push(new l(s,a,n)),"MThd"==s&&this._complain(n,"Unexpected chunk type","MThd"),e+=h}o!=this.ntrk&&(this._complain(i+10,"Incorrect number of tracks",this.ntrk),this.ntrk=o),this.ntrk||d("No MIDI tracks"),(!this.type&&1<this.ntrk||2<this.type)&&(this.type=1),e<t.length&&this._complain(i+e,"Extra trailing characters",t.length-e),e>t.length&&this._complain(i+t.length,"Incomplete data",e-t.length)},c.prototype.toString=function(){var t=[];return void 0!==this.off&&t.push("offset "+this.off),void 0!==this.track&&t.push("track "+this.track),void 0!==this.tick&&t.push("tick "+this.tick),t.join(" ")+" -- "+this.msg+" ("+this.data+")"},a.prototype.validate=function(){var t,i,r=[];if(this._warn)for(t=0;t<this._warn.length;t++)r.push(c(this._warn[t]));for(t=i=0;t<this.length;t++)this[t]instanceof y&&this[t]._validate(r,++i,1==this.type?t:0);if(r.sort(function(t,i){return(t.off||0)-(i.off||0)||(t.track||0)-(i.track||0)||(t.tick||0)-(i.tick||0)}),r.length)return r},a.prototype.dump=function(t){var i="";if(t)return"RIFF"+h((i=this.dump()).length+12)+"RMIDdata"+h(i.length)+i;for(var r=this.ntrk=0;r<this.length;r++)this[r]instanceof y&&this.ntrk++,i+=this[r].dump();return i=(this.ppqn?e(this.ppqn):String.fromCharCode(256-this.fps)+String.fromCharCode(this.ppf))+i,i=f+String.fromCharCode(0)+String.fromCharCode(this.type)+e(this.ntrk)+i},a.prototype.toBuffer=function(t){return Buffer.from(this.dump(t),"binary")},a.prototype.toUint8Array=function(t){for(var i=this.dump(t),t=new ArrayBuffer(i.length),r=new Uint8Array(t),o=0;o<i.length;o++)r[o]=i.charCodeAt(o);return r},a.prototype.toArrayBuffer=function(t){return this.toUint8Array(t).buffer},a.prototype.toInt8Array=function(t){return new Int8Array(this.toArrayBuffer(t))},a.prototype.toString=function(){for(var t=this.ntrk=0;t<this.length;t++)this[t]instanceof y&&this.ntrk++;var i=["SMF:","  type: "+this.type];for(this.ppqn?i.push("  ppqn: "+this.ppqn):i.push("  fps: "+this.fps,"  ppf: "+this.ppf),i.push("  tracks: "+this.ntrk),t=0;t<this.length;t++)i.push(this[t].toString());return i.join("\n")},a.prototype.player=function(){var t,i=new k;i.ppqn=this.ppqn,i.fps=this.fps,i.ppf=this.ppf,i.ppf=this.ppf;var r,o=[],e=0,n=0;for(a=0;a<this.length;a++)this[a]instanceof y&&o.push(this[a]);if(2==this.type)for(a=0;a<o.length;a++){for(t=0;t<o[a].length;t++)(r=p.MIDI(o[a][t])).track=a,n=r.tt+e,r.tt=n,i._data.push(r);e=n}else{var s=[];for(a=0;a<o.length;a++)s[a]=0;for(;;){for(var h=!0,a=0;a<o.length;a++){for(;s[a]<o[a].length&&o[a][s[a]].tt==n;)(r=p.MIDI(o[a][s[a]])).track=a,i._data.push(r),s[a]++;s[a]>=o[a].length||(h&&(e=o[a][s[a]].tt),h=!1,e>o[a][s[a]].tt&&(e=o[a][s[a]].tt))}if(n=e,h)break}}return i._type=this.type,i._tracks=o.length,i._timing(),i},(((a.Chunk=l).prototype=[]).constructor=l).prototype.copy=function(){return new l(this.type,this.data)},l.prototype.sub={MTrk:function(t,i,r){return new y(i,r)}},l.prototype.dump=function(){return this.type+s(this.data.length)+this.data},l.prototype.toString=function(){return this.type+": "+this.data.length+" bytes"},(((a.MTrk=y).prototype=[]).constructor=y).prototype.type="MTrk",y.prototype.copy=function(){for(var t=new y,i=t.length=0;i<this.length;i++)t.push(new p.MIDI(this[i]));return t},y.prototype._validate=function(t,i,r){var o,e;if(this._warn)for(o=0;o<this._warn.length;o++)(e=c(this._warn[o])).track=i,t.push(e);for(o=0;o<this.length;o++)(e=function(t,i){var r;if(void 0!==t.ff)return 127<t.ff?u(t._off,"Invalid meta event",C(t),t.tt):0!=t.ff?t.ff<10?t.dd.length?void 0:u(t._off,"Invalid Text meta event: no data",C(t),t.tt):32==t.ff?(r=v(t,"Channel Prefix",1))?r:15<t.dd.charCodeAt(0)?u(t._off,"Invalid Channel Prefix meta event: incorrect data",C(t),t.tt):void 0:33==t.ff?(r=v(t,"MIDI Port",1))?r:127<t.dd.charCodeAt(0)?u(t._off,"Invalid MIDI Port meta event: incorrect data",C(t),t.tt):void 0:47!=t.ff?81==t.ff?(r=v(t,"Tempo",3))?r:i?A(t,"Tempo"):void 0:84==t.ff?(r=v(t,"SMPTE",5))?r:24<=t.dd.charCodeAt(0)||60<=t.dd.charCodeAt(1)||60<=t.dd.charCodeAt(2)||30<=t.dd.charCodeAt(3)||200<=t.dd.charCodeAt(4)||t.dd.charCodeAt(4)%25?u(t._off,"Invalid SMPTE meta event: incorrect data",C(t),t.tt):i?A(t,"SMPTE"):void 0:88==t.ff?(r=v(t,"Time Signature",4))?r:8<t.dd.charCodeAt(1)?u(t._off,"Invalid Time Signature meta event: incorrect data",C(t),t.tt):i?A(t,"Time Signature"):void 0:89==t.ff?(r=v(t,"Key Signature",2))?r:1<t.dd.charCodeAt(1)||255<t.dd.charCodeAt(0)||7<t.dd.charCodeAt(0)&&t.dd.charCodeAt(0)<249?u(t._off,"Invalid Key Signature meta event: incorrect data",t.toString(),t.tt):void 0:127!=t.ff?u(t._off,"Unknown meta event",C(t),t.tt):void 0:(r=v(t,"End of Track",0))?r:void 0:(r=v(t,"Sequence Number",2))?r:void 0}(this[o],r))&&(e.track=i,t.push(c(e)))},y.prototype._complain=function(t,i,r,o){this._warn||(this._warn=[]),this._warn.push(u(t,i,r,o))},y.prototype.dump=function(){for(var t,i="",r=0,o="",e=0;e<this.length;e++)if(i+=n(this[e].tt-r),r=this[e].tt,void 0!==this[e].dd)i+="ÿ",i+=String.fromCharCode(this[e].ff),i+=n(this[e].dd.length),i+=this[e].dd;else if(240==this[e][0]||247==this[e][0])for(i+=String.fromCharCode(this[e][0]),i+=n(this[e].length-1),t=1;t<this[e].length;t++)i+=String.fromCharCode(this[e][t]);else for(this[e][0]!=o&&(o=this[e][0],i+=String.fromCharCode(this[e][0])),t=1;t<this[e].length;t++)i+=String.fromCharCode(this[e][t]);return"MTrk"+s(i.length)+i},y.prototype.toString=function(){for(var t=["MTrk:"],i=0;i<this.length;i++)t.push(this[i].tt+": "+this[i].toString());return t.join("\n  ")},y.prototype.add=function(t,i){if(t=parseInt(t),(isNaN(t)||t<0)&&d("Invalid parameter"),(i=p.MIDI(i)).tt=t,this[this.length-1].tt<t&&(this[this.length-1].tt=t),47==i.ff||255==i[0])return this;for(var r=0;r<this.length-1&&!(this[r].tt>t);r++);return this.splice(r,0,i),this},y.prototype._ch=void 0,y.prototype._sxid=127,y.prototype._image=function(){var t=function(){};t.prototype=this._orig;t=new t;return t._ch=this._ch,t._sxid=this._sxid,t._tick=this._tick,t},y.prototype.send=function(t){return this._orig.add(this._tick,t),this},y.prototype.tick=function(t){if(t!=parseInt(t)||t<0)throw RangeError("Bad tick value: "+t);if(!t)return this;var i=this._image();return i._tick=this._tick+t,i},y.prototype.sxId=function(t){if((t=void 0===t?y.prototype._sxid:t)==this._sxid)return this;if(t!=parseInt(t)||t<0||127<t)throw RangeError("Bad MIDI value: "+t);var i=this._image();return i._sxid=t,i},y.prototype.ch=function(t){if(t==this._ch||void 0===t&&void 0===this._ch)return this;if(void 0!==t&&(t!=parseInt(t)||t<0||15<t))throw RangeError("Bad channel value: "+t+" (must be from 0 to 15)");var i=this._image();return i._ch=t,i},y.prototype.note=function(t,i,r,o){return this.noteOn(t,i,r),void 0===this._ch?0<o&&this.tick(o).noteOff(t,i):0<r&&this.tick(r).noteOff(t),this},p.lib.copyMidiHelpers(y),k.prototype.onEnd=function(){},k.prototype.loop=function(t){t==parseInt(t)&&0<t?this._loop=t:this._loop=t?-1:0},k.prototype.play=function(){this.event=void 0,this.playing=!0,this.paused=!1,this._ptr=0,this._pos=0,this._p0=0,this._t0=r(),this.tick()},k.prototype.stop=function(){this._pos=0,this.playing=!1,this.event="stop",this.paused=void 0},k.prototype.pause=function(){this.event="pause"},k.prototype.resume=function(){this.playing||(this.paused?(this.event=void 0,this._t0=r(),this.playing=!0,this.paused=!1,this.tick()):this.play())},k.prototype.sndOff=function(){for(var t=0;t<16;t++)this._emit(p.MIDI.allSoundOff(t));for(t=0;t<16;t++)this._emit(p.MIDI.resetAllControllers(t))},k.prototype._filter=i,k.prototype.filter=function(t){this._filter=t instanceof Function?t:i},k.prototype._receive=function(t){81==t.ff&&this.ppqn&&(this._mul=1e3*this.ppqn/S(t.dd),this.mul=this._mul*this._speed,this._t0=r(),this._p0=this._pos),this._emit(t)},k.prototype.tick=function(){var t,i=r();for(this._pos=this._p0+(i-this._t0)*this.mul;this._ptr<this._data.length&&!((t=this._data[this._ptr]).tt>this._pos);this._ptr++)this._filter(t);this._ptr>=this._data.length&&(this._loop&&-1!=this._loop&&this._loop--,this._loop?(this._ptr=0,this._p0=0,this._t0=i):this.stop(),this.onEnd()),"stop"==this.event&&(this.playing=!1,this.paused=!1,this._pos=0,this._ptr=0,this.sndOff(),this.event=void 0),"pause"==this.event&&(this.playing=!1,this.paused=!0,this._pos>=this._duration&&(this._pos=this._duration-1),this._p0=this._pos,this.sndOff(),this.event=void 0),this.playing&&p.lib.schedule(this._tick)},k.prototype.trim=function(){for(var t,i=[],r=0,o=0,e=0;e<this._data.length;e++)if((t=this._data[e]).length||1==t.ff||5==t.ff)for(;o<=e;o++)i.push(this._data[o]);return r+=this._data[e-1].tt-this._data[o-1].tt,this._data=i,this._timing(),r},k.prototype._timing=function(){var t,i,r,o;if(this._duration=this._data[this._data.length-1].tt,this._ttt=[],this.ppqn){for(this._mul=this.ppqn/500,i=this._mul,this._durationMS=r=0,this._ttt.push({t:0,m:i,ms:0}),t=0;t<this._data.length;t++)81==(o=this._data[t]).ff&&(this._durationMS+=(o.tt-r)/i,r=o.tt,i=1e3*this.ppqn/S(o.dd),this._ttt.push({t:r,m:i,ms:this._durationMS}));this._durationMS+=(this._duration-r)/i}else this._mul=this.fps*this.ppf/1e3,this._ttt.push({t:0,m:this._mul,ms:0}),this._durationMS=this._duration/this._mul;this._speed=1,this.mul=this._mul,this._ttt.push({t:this._duration,m:0,ms:this._durationMS}),this._durationMS||(this._durationMS=1)},k.prototype.speed=function(t){return void 0!==t&&((isNaN(parseFloat(t))||t<=0)&&(t=1),this._speed=t,this.mul=this._mul*this._speed,this._p0=this._pos-(r()-this._t0)*this.mul),this._speed},k.prototype.type=function(){return this._type},k.prototype.tracks=function(){return this._tracks},k.prototype.duration=function(){return this._duration},k.prototype.durationMS=function(){return this._durationMS},k.prototype.position=function(){return this._pos},k.prototype.positionMS=function(){return this.tick2ms(this._pos)},k.prototype.jump=function(t){isNaN(parseFloat(t))&&d("Not a number: "+t),(t=t<0?0:t)>=this._duration&&(t=this._duration-1),this._goto(t)},k.prototype.jumpMS=function(t){isNaN(parseFloat(t))&&d("Not a number: "+t),(t=t<0?0:t)>=this._durationMS&&(t=this._durationMS-1),this._goto(this._ms2t(t))},k.prototype._t2ms=function(t){if(!t)return 0;for(var i=0;this._ttt[i].t<t;i++);return this._ttt[--i].ms+(t-this._ttt[i].t)/this._ttt[i].m},k.prototype._ms2t=function(t){if(!t)return 0;for(var i=0;this._ttt[i].ms<t;i++);return this._ttt[--i].t+(t-this._ttt[i].ms)*this._ttt[i].m},k.prototype._goto=function(t){this._pos=t,this.playing||(this.paused=!!t),this._toPos(),this.playing&&this.sndOff()},k.prototype._toPos=function(){for(this._ptr=0;this._ptr<this._data.length;this._ptr++){var t=this._data[this._ptr];if(t.tt>=this._pos)break;81==t.ff&&this.ppqn&&(this._mul=1e3*this.ppqn/S(t.dd))}this.mul=this._mul*this._speed,this._t0=r(),this._p0=this._pos},k.prototype.tick2ms=function(t){return isNaN(parseFloat(t))&&d("Not a number: "+t),t<=0?0:t>=this._duration?this._durationMS:this._t2ms(t)},k.prototype.ms2tick=function(t){return isNaN(parseFloat(t))&&d("Not a number: "+t),t<=0?0:t>=this._durationMS?this._duration:this._ms2t(t)},p.MIDI.SMF=a)});